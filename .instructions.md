# Poker Tournament Clock - Copilot Instructions

## Project Overview

This is a poker tournament clock application that displays a full-screen countdown timer for poker tournaments. It supports multiple tournament configurations and generates self-contained HTML files with embedded CSS and JavaScript from YAML configuration files.

**Key Features:**
- Large countdown timer with visual warnings
- Multiple tournament configurations (up to 10 different config files)
- Configurable tournament rounds via YAML
- Automatic progression between rounds
- Manual round advancement (ENTER key)
- Break indicator with different styling
- Keyboard control (spacebar to start/pause, ENTER to advance)
- Full-screen optimized for any device
- Static HTML deployment via GitHub Pages

## Technology Stack

- **Backend/Build**: Python 3.11 (CI/CD uses this version; likely compatible with Python 3.7+)
  - PyYAML 6.0.1 for configuration parsing
- **Frontend**: Pure HTML, CSS, and JavaScript
  - No external dependencies or frameworks
  - Self-contained single-file application
- **Deployment**: GitHub Actions + GitHub Pages
- **Configuration**: YAML (config.yml)

## File Structure

- `generate_clock.py` - Python script that generates the HTML files
- `config-*.yml` - Tournament configuration files (e.g., config-tourney.yml, config-league.yml)
- `index.html` - Generated index page with links to all tournament clocks (DO NOT EDIT DIRECTLY)
- `clock-*.html` - Generated clock pages for each configuration (DO NOT EDIT DIRECTLY)
- `.github/workflows/deploy.yml` - GitHub Pages deployment workflow
- `requirements.txt` - Python dependencies
- `README.md` - User-facing documentation
- `USAGE.md` - Detailed usage instructions

## Build Instructions

1. Install Python dependencies:
   ```bash
   pip install -r requirements.txt
   ```

2. Create one or more configuration files following the pattern `config-*.yml`:
   - `config-tourney.yml` - Standard tournament configuration
   - `config-league.yml` - League play configuration
   - You can create up to 10 different configurations

3. Generate the HTML files:
   ```bash
   python generate_clock.py
   ```

This reads all `config-*.yml` files and generates:
- `index.html` - Landing page with links to all tournament clocks
- `clock-*.html` - Individual clock pages for each configuration

## Testing Guidelines

**Manual Testing:**
1. After generating the HTML files, open `index.html` in a web browser
2. Verify all tournament configurations are listed as links
3. Click on each link to test the corresponding clock page
4. Test spacebar functionality (start/pause)
5. Test ENTER key functionality (advance to next round manually)
6. Verify timer countdown works correctly
7. Test visual warnings (orange pulsing at 2-minute warning, red flashing during final 10 seconds)
8. Verify auto-progression to next round
9. Test break rounds (different background color)

**Configuration Validation:**
- The script validates that each config file contains a 'rounds' key
- Each round must have valid duration (positive number)
- The script automatically detects all `config-*.yml` files (up to 10)
- Test with various configurations to ensure robustness

**Multi-Configuration Testing:**
- Create multiple config files with different names
- Verify the script finds all config files
- Verify each config generates a separate HTML file
- Verify the index page links to all generated clock pages
- Test that config names are properly formatted in the UI

**Note:** This project currently has no automated unit tests. Manual testing is required.

## Deployment

The project automatically deploys to GitHub Pages via GitHub Actions when:
- Code is pushed to the `main` branch
- Workflow is manually triggered via workflow_dispatch

The workflow:
1. Checks out the repository
2. Sets up Python 3.11
3. Installs dependencies
4. Runs `generate_clock.py`
5. Uploads and deploys to GitHub Pages

## Coding Guidelines

### Python Code
- Code is compatible with Python 3.7+ (avoid version-specific features unless necessary)
- CI/CD pipeline uses Python 3.11
- Follow PEP 8 style guidelines
- Use descriptive variable and function names
- Include docstrings for functions
- Validate input data (especially YAML configuration)
- Use type hints where appropriate
- Handle errors gracefully with informative messages

### HTML/CSS/JavaScript
- Write clean, readable, self-documenting code
- Use semantic HTML
- Keep CSS organized and well-commented
- Use vanilla JavaScript (no frameworks)
- Maintain mobile responsiveness
- Ensure accessibility where possible

### YAML Configuration
- Keep configuration simple and readable
- Include comments explaining each field
- Maintain consistent structure
- Duration values are in minutes (converted to seconds by script)

## Important Constraints

1. **Generated HTML files**: Never edit `index.html` or `clock-*.html` files directly. All changes must be made to `generate_clock.py` or `config-*.yml` files.

2. **Self-contained output**: The generated HTML files must be completely self-contained with no external dependencies (all CSS and JavaScript embedded).

3. **No external libraries in frontend**: The clock must work with pure HTML/CSS/JS only.

4. **Configuration file naming**: Config files must follow the pattern `config-*.yml` to be automatically detected.

5. **Maximum configurations**: The system supports up to 10 different configuration files.

6. **Backwards compatibility**: Changes to config file format should maintain compatibility with existing configurations where possible.

## Common Tasks

### Adding a new tournament configuration
Create a new file following the naming pattern `config-<name>.yml`:
```yaml
# config-fast.yml
rounds:
  - number: 1
    name: "Round Name or Blinds"
    duration: 10  # in minutes
    is_break: false
```
Then run `python generate_clock.py` to generate the clock page.

### Adding a new round to an existing configuration
Edit the appropriate `config-*.yml` file and add a new round entry:
```yaml
- number: X
  name: "Round Name or Blinds"
  duration: Y  # in minutes
  is_break: false
```

### Modifying visual appearance
Edit the HTML template in `generate_clock.py` (within the `generate_clock_html` or `generate_index_html` functions).

### Changing timer logic
Modify the JavaScript code embedded in the HTML template within `generate_clock.py`.

### Testing changes locally
1. Make changes to `generate_clock.py` or `config-*.yml` files
2. Run `python generate_clock.py`
3. Open `index.html` in a browser
4. Select a tournament configuration
5. Test the timer functionality

## Error Handling

The script should handle these scenarios gracefully:
- No config files found (displays helpful message)
- Missing or invalid config file
- Invalid YAML syntax
- Missing required fields in configuration
- Invalid duration values (non-numeric, negative, or zero)
- Empty rounds list
- More than 10 config files (uses first 10 and shows warning)

All errors should provide clear, actionable error messages.

## Development Workflow

1. Make changes to source files (`generate_clock.py` or `config-*.yml` files)
2. Test locally by running the generator and opening the HTML files
3. Verify functionality works as expected for all configurations
4. Commit changes (including regenerated HTML files)
5. Push to trigger automatic deployment

## Notes for Copilot

- When modifying the timer logic, ensure backward compatibility.
- Visual changes should maintain readability on large screens.
- Keep the user interface simple and intuitive.
- Preserve the single-file, self-contained nature of the output.
- Consider screen size variations when making layout changes.
- Test generated HTML in multiple browsers if making significant changes.
- Remember that multiple config files are now supported - test changes with multiple configurations.
- The index page is now a landing page with links - test navigation between pages.
- Manual round advancement (ENTER key) pauses the timer, while automatic advancement keeps it running.
